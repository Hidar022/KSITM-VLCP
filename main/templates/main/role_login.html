{% extends 'main/base.html' %}
{% load static %}
{% load widget_tweaks %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/auth.css' %}">
{% endblock %}

{% block page_wrapper %}
<div class="auth-wrapper">

    <!-- Floating shapes -->
    <div class="floating-shape shape1"></div>
    <div class="floating-shape shape2"></div>

    <!-- Unified container -->
    <div class="auth-container">

        <!-- Left info panel -->
        <div class="auth-info" data-aos="fade-right">
            <h2>Welcome to KSITM VLCP</h2>
            <p>
                Our mission is to provide a seamless virtual learning experience. 
                Engage with your courses, interact with lecturers, and track your progressâ€”all in one platform.
            </p>
            <p>
                Explore our resources, submit assignments, and stay updated with notifications.
            </p>
        </div>

        <!-- Right login panel -->
        <div class="auth-box" data-aos="zoom-in">

            <!-- Logo -->
            <div class="logo-circle">
                <img src="{% static 'images/ksitm_logo.png' %}" alt="KSITM Logo">
            </div>

            <h3 class="mb-4">Login</h3>

            <!-- Role Tabs -->
            <div class="role-tab-container">
                <div id="tab-student" class="role-tab active-role" onclick="switchRole('student')">Student</div>
                <div id="tab-lecturer" class="role-tab" onclick="switchRole('lecturer')">Lecturer</div>
                <div id="tab-admin" class="role-tab" onclick="switchRole('admin')">Admin</div>
            </div>

            <!-- Login Form -->
            <form method="POST" action="{% url 'login' %}">
                {% csrf_token %}
                <input type="hidden" name="role" id="roleInput" value="student" autocomplete="off">

                {% if form.non_field_errors %}
                <div class="form-errors">
                    {% for error in form.non_field_errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
                {% endif %}

                <label>Username</label>
                {{ form.username|add_class:"form-control" }}

                <label>Password</label>
                {{ form.password|add_class:"form-control" }}

                <div id="lecturer-id-box">
                    <label>Lecturer ID</label>
                    {{ form.lecturer_id|add_class:"form-control" }}
                </div>

                <button type="submit" class="submit-btn">Login</button>
            </form>

            <p id="registerBox" class="text-link">
                Don't have an account? <a href="{% url 'register' %}">Register</a>
            </p>

        </div>
    </div>
</div>

<script>
    function switchRole(role) {
        document.getElementById("roleInput").value = role;
        document.querySelectorAll(".role-tab").forEach(t => t.classList.remove("active-role"));
        document.getElementById("tab-" + role).classList.add("active-role");
        document.getElementById("lecturer-id-box").style.display = role === "lecturer" ? "block" : "none";
        document.getElementById("registerBox").style.display = role === "student" ? "block" : "none";
    }

    window.onload = () => switchRole("student");
</script>
{% endblock %}
